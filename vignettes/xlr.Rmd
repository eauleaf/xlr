---
title: "xlr"
author: "Eauleaf"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{xlr}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## ***R + Spreadsheets***

<br>

# Overview of xlr

The *`xlr`* package is about 10 functions to make it easier to move
information between R and spreadsheets.

### Reasons for *`xlr`*:

Spreadsheets are an excellent tool for presenting 2-dimensional data in
a reader-friendly format and spreadsheets are the workhorse of the
business community. However, spreadsheets don't have the flexibility or
raw horsepower of R, so its helpful to use R for the data processing,
and then pump standardized, reviewable tables out to workbook
spreadsheets for review, as long as the effort is minimal.

## To get started:

```{r install-xlr, eval = F}
remotes::install_github('eauleaf/xlr')
library(xlr)
```

## Primary xlr functions

#### --ordered by use frequency--

-   `xlr()` -- quickly view multiple datasets as sheets in a workbook
-   `enlist()` -- quickly produce named lists of your data
-   `copy_for_xl()` -- copy an R dataset to clipboard memory for pasting
    to a spreadsheet
-   `paste_from_xl()` -- copy spreadsheet data to clipboard memory for
    pasting in R
-   `enscript()` -- produce the code to re-create most any R object
-   `repeated()` -- flag all repeats in a vector
-   `list_iron()` -- flatten lists of embedded lists to a named,
    single-file list
-   `entibble()` -- create tibbles with default behavior useful for
    workbook view

<br>

# Function Details

### `xlr()`

`xlr()` is the primary function, and the package is named after it. Many
of the other functions in the package are there to help `xlr()`. The
function is somewhat similar to `View()` from the utils package in that
`xlr()` is for quickly viewing datasets. `xlr()` makes it easy to view
multiple related datasets via spreasheets in a workbook, change your
code, view the data again--rinse repeat.

It's easiest to see what `xlr()` does by passing it some example data;
type in something like:

```         
xlr(mtcars, iris, letters, Titanic, AirPassengers)
```

If you send that code to the console, you should get a workbook that
opens automatically with those datasets presented in a standardized,
formatted spreadsheets. Once you've looked the workbook over, all you
have to do is close it; your spreadsheets are temporary. Close them and
they're gone.

### Use Details

To use `xlr()`, pass it a dataframe or a list of dataframes. It does not
matter if you pass nested lists of lists, `xlr()` will flatten and
auto-name the workbook and the spreadsheet tabs.

```         
xlr(some_datasets = enlist(flowers = iris, mtcars, datasets::USArrests)) 

iris |> split(f = iris$Species) |> xlr()
```

`xlr()` writes the workbook in a temp directory and removes the savefile
5 minutes after write time to keep them from building up. Temp
directories delete themselves when you close R. If, however, you want to
save a workbook, specify a path or a save name in parameter `.path`;
specified savenames don't get marked for cleanup. (Note that `.path`
uses `here::here()` internally.)

`xlr()` entibbles all datasets you pass, and will optionally (invisibly)
return the `tibble` data objects in a list, the `openxlsx` workbook
object, or the path string, as specified through parameter `.return`.

### `enlist()`

`enlist()` is a convenience function for creating and naming lists,
without unnecessary list nesting.

### `copy_for_xl()`

`copy_for_xl()` is a

The functions Install package `clipr` and check that it works by running
`clipr::dr_clipr().`
